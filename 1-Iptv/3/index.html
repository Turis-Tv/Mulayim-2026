 <!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>IPTV Player</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/dashjs/dist/dash.all.min.js"></script>
  <style>
    body { margin:0; font-family:sans-serif; display:flex; height:100vh; background:#000; overflow:hidden; }

    /* Sidebar (playlist) */
    #sidebar {
      width:300px; background:rgba(20,20,20,0.95); color:#fff;
      border-right:1px solid #333;
      overflow:auto; padding:10px;
      position:fixed; top:0; left:-320px; bottom:0;
      transition:left 0.3s ease;
      z-index:1000;
      backdrop-filter: blur(6px);
    }
    #sidebar.show { left:0; }

    /* Video container */
    #content { flex:1; display:flex; flex-direction:column; width:100%; height:100%; }
    #video { flex:1; width:100%; height:100%; background:#000; }

    /* Mooie hamburger knop */
    #hamburger {
      position:fixed; top:15px; left:15px; z-index:1100;
      width:44px; height:44px;
      display:flex; align-items:center; justify-content:center;
      background:rgba(0,0,0,0.5);
      border-radius:50%;
      border:1px solid rgba(255,255,255,0.25);
      cursor:pointer;
      color:#fff; font-size:22px;
      transition:all 0.25s ease;
    }
    #hamburger:hover {
      background:rgba(255,255,255,0.15);
      transform:scale(1.1);
    }

    /* Groepen en kanalen */
    .group { 
      font-weight:bold; margin-top:12px; background:#222; color:#fff;
      padding:8px; cursor:pointer; border-radius:6px;
    }
    .list { display:none; margin-top:6px; }
    .channel { 
      padding:10px 12px;
      margin:6px 0;
      border-radius:10px;
      background:rgba(255,255,255,0.08);
      border:1px solid rgba(255,255,255,0.15);
      cursor:pointer;
      color:#fff;
      transition:all 0.25s ease;
      backdrop-filter: blur(4px);
    }
    .channel:hover {
      background:rgba(255,255,255,0.2);
      transform:translateX(5px);
      box-shadow:0 4px 12px rgba(0,0,0,0.4);
    }

    /* Mobiel fullscreen styling */
    @media (max-width: 768px) {
      #video {
        position:fixed;
        top:0; left:0;
        width:100vw;
        height:100vh;
        object-fit:contain; /* behoud verhouding */
        background:#000;
        z-index:500;
      }
      #sidebar {
        width:85%; /* iets smaller voor mobiel */
      }
    }
  </style>
</head>
<body>
  <!-- Hamburger knop -->
  <div id="hamburger">â˜°</div>

  <!-- Playlist sidebar -->
  <div id="sidebar">
    <h3>Kanalen</h3>
    <div id="groups"></div>
  </div>

  <!-- Player -->
  <div id="content">
    <video id="video" controls autoplay playsinline></video>
  </div>

<script>
const M3U_URL = "https://raw.githubusercontent.com/Turis-Tv/Turis-Tv-m3u/refs/heads/main/tv.m3u";

const sidebar=document.getElementById('sidebar');
const hamburger=document.getElementById('hamburger');
const video=document.getElementById('video');
const groupsEl=document.getElementById('groups');
let hls,dash;

/* toggle playlist links */
hamburger.onclick = () => {
  sidebar.classList.toggle('show');
};

function toHttps(u){return u.replace(/^http:/,'https:');}

function play(url,title){
  url=toHttps(url);
  if(hls){hls.destroy();hls=null;}
  if(dash){dash.reset();dash=null;}
  video.src=""; video.load();

  if(url.endsWith('.m3u8') && Hls.isSupported()){
    hls=new Hls();hls.loadSource(url);hls.attachMedia(video);
  } else if(url.endsWith('.mpd')){
    dash=dashjs.MediaPlayer().create();dash.initialize(video,url,true);
  } else {
    video.src=url;video.play();
  }

  // Na kanaalkeuze: sidebar sluiten
  sidebar.classList.remove('show');

  // Probeer fullscreen (voor mobiel)
  if (video.requestFullscreen) {
    video.requestFullscreen();
  } else if (video.webkitEnterFullscreen) { // Safari iOS
    video.webkitEnterFullscreen();
  } else if (video.msRequestFullscreen) {
    video.msRequestFullscreen();
  }
}

function parseM3U(txt){
  const lines=txt.split('\n');
  let title="",group="Overig";
  const groups={};
  for(const line of lines){
    const l=line.trim();
    if(l.startsWith('#EXTINF')){
      title=l.split(',').pop()||'Onbekend';
      group=(l.match(/group-title="(.*?)"/)||[,'Overig'])[1];
    } else if(l && !l.startsWith('#')){
      if(!groups[group]) groups[group]=[];
      groups[group].push({title,url:toHttps(l)});
    }
  }
  render(groups);
}

function render(groups){
  groupsEl.innerHTML="";
  for(const [g,chs] of Object.entries(groups)){
    const gEl=document.createElement('div');
    gEl.className="group"; gEl.textContent=g;
    const list=document.createElement('div'); list.className="list";
    chs.forEach(c=>{
      const ch=document.createElement('div');
      ch.className="channel"; ch.textContent=c.title;
      ch.onclick=()=>play(c.url,c.title);
      list.appendChild(ch);
    });
    gEl.onclick=()=> list.style.display=(list.style.display==="none"?"block":"none");
    groupsEl.appendChild(gEl);
    groupsEl.appendChild(list);
  }
}

fetch(M3U_URL).then(r=>r.text()).then(parseM3U)
.catch(()=>alert("Kon M3U niet laden"));
</script>
</body>
</html>
